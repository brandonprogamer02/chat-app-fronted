(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{153:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(17),s=r.n(c),o=r(5),i=r.n(o),u=r(10),l=r(8),d=r(4),A=r.p+"static/media/logout.796c4552.png",b=r.p+"static/media/foto-perfil.a059d971.png",j={VIEW_LISTA_CHAT:{value:"VIEW_LISTA_CHAT",display:"d-hidden-chat"},VIEW_CHAT:{value:"VIEW_CHAT",display:"d-hidden-chat"},VIEW_AUTH:{value:"VIEW_AUTH",display:"d-hidden"},VIEW_LOGIN:{value:"VIEW_LOGIN",display:""},VIEW_SIGNIN:{value:"VIEW_SIGNIN",display:"d-hidden"}};function E(e,t){switch(t){case j.VIEW_CHAT.value:var r=j;return r.VIEW_CHAT.display="",r.VIEW_LISTA_CHAT.display="d-hidden-chat",r.VIEW_AUTH.display="d-hidden",r.VIEW_LOGIN.display="d-hidden",r.VIEW_SIGNIN.display="d-hidden",r;case j.VIEW_LISTA_CHAT.value:var a=j;return a.VIEW_CHAT.display="d-hidden-chat",a.VIEW_AUTH.display="d-hidden",a.VIEW_LISTA_CHAT.display="",a.VIEW_LOGIN.display="d-hidden",a.VIEW_SIGNIN.display="d-hidden",a;case j.VIEW_AUTH.value:var n=j;return n.VIEW_CHAT.display="d-hidden-chat",n.VIEW_LISTA_CHAT.display="d-hidden-chat",n.VIEW_AUTH.display="",n.VIEW_LOGIN.display="d-hidden",n.VIEW_SIGNIN.display="d-hidden",n;case j.VIEW_LOGIN.value:var c=j;return c.VIEW_CHAT.display="d-hidden-chat",c.VIEW_LISTA_CHAT.display="d-hidden-chat",c.VIEW_AUTH.display="d-hidden",c.VIEW_LOGIN.display="",c.VIEW_SIGNIN.display="d-hidden",c;case j.VIEW_SIGNIN.value:var s=j;return s.VIEW_CHAT.display="d-hidden-chat",s.VIEW_LISTA_CHAT.display="d-hidden-chat",s.VIEW_AUTH.display="d-hidden",s.VIEW_LOGIN.display="d-hidden",s.VIEW_SIGNIN.display="",s;default:return e}}var f={setView:function(e){},activeChatId:"",setActiveChatId:function(e){}},h=n.a.createContext(f),p=r(1);var S,v,O=function(){var e=Object(d.c)((function(e){return e.user})),t=Object(a.useContext)(h).setView;return Object(p.jsxs)("div",{className:"bg-primary d-flex justify-content-between px-4 py-3 border-shadow-title",children:[Object(p.jsxs)("div",{className:"",children:[Object(p.jsx)("h3",{className:"c-white",children:"Chat App"}),Object(p.jsx)("span",{className:"c-white ",children:e.result.username})]}),Object(p.jsxs)("div",{className:"d-flex align-items-center",children:[Object(p.jsx)("img",{src:b,alt:"foto de perfil",width:"70px",className:"rounded-circle mx-2"}),Object(p.jsx)("img",{src:A,alt:"cerrar sesion",width:"30px",height:"30px",className:"mx-2 hover",onClick:function(){localStorage.removeItem("token"),t(j.VIEW_LOGIN.value)}})]})]})},m=r(41);!function(e){e.SEARCH_USER_API_SUCESSS="SEARCH_USER_API_SUCESSS",e.SEARCH_USER_API_STARTED="SEARCH_USER_API_STARTED",e.SEARCH_USER_API_ERROR="SEARCH_USER_API_ERROR"}(S||(S={})),function(e){e.SET_USERS_SEARCH_MODE_ACTIVE_SYNC="SET_USERS_SEARCH_MODE_ACTIVE_SYNC",e.SET_INDEX_USER_SEARCHED_SELECTED="SET_INDEX_USER_SEARCHED_SELECTED"}(v||(v={}));var I=function(e){return{type:v.SET_INDEX_USER_SEARCHED_SELECTED,payload:{indexUserSearchedSelected:e}}},_=r(87),g=r.n(_).a.create({baseURL:"https://brandox-chat-app.herokuapp.com"});var T=function(){var e=Object(u.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.get("user/",{params:{username:t}});case 3:return r=e.sent,e.abrupt("return",!!r.data[0]);case 7:return e.prev=7,e.t0=e.catch(0),console.log("Verifing user exists. Error ".concat(null===(a=e.t0.response)||void 0===a?void 0:a.data)),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(i.a.mark((function e(t){var r,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.get("user/",{params:{token:t}});case 3:return r=e.sent,a=r.data.user,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),console.log("Getting user by token. Error ".concat(null===(n=e.t0.response)||void 0===n?void 0:n.data)),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();var x=function(e){return function(t,r){t({type:S.SEARCH_USER_API_STARTED,payload:{}}),t(I(-1)),function(e,t,r){g.get("/user",{params:{username:e}}).then((function(e){return t&&t(e.data)})).catch((function(e){var t;console.log("Getting user by name. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data)),r&&r(e)}))}(e,(function(e){return t((r=e,{type:S.SEARCH_USER_API_SUCESSS,payload:{usersSearchData:r}}));var r}),(function(e){return t(function(e){return{type:S.SEARCH_USER_API_ERROR,payload:{error:e}}}(e))}))}},R=function(e){return{type:v.SET_USERS_SEARCH_MODE_ACTIVE_SYNC,payload:{active:e}}};var y,N=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),r=t[0],n=t[1],c=Object(m.useDebounce)(r,800),s=Object(l.a)(c,1)[0],o=Object(a.useState)(0),A=Object(l.a)(o,2),b=A[0],j=A[1],E=Object(d.b)(),f=Object(d.c)((function(e){return e.searchUsers}));return Object(a.useEffect)((function(){f.loading||setTimeout((function(){return j(-1)}),500)}),[f.loading]),Object(a.useEffect)((function(){Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""===r?(E(R(!1)),E(x(""))):(E(R(!0)),E(x(r)));case 1:case"end":return e.stop()}}),e)})))()}),[s]),Object(a.useEffect)((function(){j(0)}),[r]),Object(p.jsxs)("div",{className:"pb-2 py-1",children:[Object(p.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{zIndex:b,position:"absolute",width:"100%",height:"100%"},children:Object(p.jsx)("div",{className:"spinner-border ml-2 text-primary",style:{width:60,height:60}})}),Object(p.jsx)("input",{type:"password",id:"prevent_autofill",autoComplete:"off",style:{display:"none"},tabIndex:-1}),Object(p.jsxs)("div",{className:"input-group mb-3",children:[Object(p.jsx)("input",{value:r,onChange:function(e){var t=e.currentTarget.value;n(t)},className:"form-control",placeholder:"Buscar Chat o Usuarios",style:{backgroundColor:"#F8F9F9"}}),Object(p.jsx)("button",{className:"btn btn-danger",type:"button",onClick:function(){return n("")},children:"X"})]})]})},D=r(2),H={author:"",createdAt:new Date,members:[],messages:[]};function P(e,t,r){g.delete("/chat/"+e).then((function(e){return t&&t(e.data)})).catch((function(e){var t;console.log("Deleting chat. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data)),r&&r(e)}))}!function(e){e[e.NEW_MESSAGE=0]="NEW_MESSAGE",e[e.DELETE_MESSAGE=1]="DELETE_MESSAGE"}(y||(y={}));var U,w,k,B="UPDATE_CHAT",F="DELETE_CHAT";!function(e){e.UPDATE_CHAT_API_STARTED="UPDATE_CHAT_API_STARTED",e.UPDATE_CHAT_API_SUCESSS="UPDATE_CHAT_API_SUCESSS",e.UPDATE_CHAT_API_ERROR="UPDATE_CHAT_API_ERROR"}(U||(U={})),function(e){e.FIND_CHAT_API_STARTED="FIND_CHAT_API_STARTED",e.FIND_CHAT_API_SUCESSS="FIND_CHAT_API_SUCESSS",e.FIND_CHAT_API_ERROR="FIND_CHAT_API_ERROR"}(w||(w={})),function(e){e.DELETE_CHAT_API_STARTED="DELETE_CHAT_API_STARTED",e.DELETE_CHAT_API_SUCESSS="DELETE_CHAT_API_SUCESSS",e.DELETE_CHAT_API_ERROR="DELETE_CHAT_API_ERROR"}(k||(k={}));var V=function(e){return function(t,r){t({type:w.FIND_CHAT_API_STARTED}),function(e,t,r){g.get("/chat/"+e).then((function(e){return t&&t(e.data)})).catch((function(e){var t;r&&r(e),console.log("delete message. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data))}))}(e,(function(e){return t((r=e,{type:w.FIND_CHAT_API_SUCESSS,payload:r}));var r}),(function(e){return t(function(e){return{type:w.FIND_CHAT_API_ERROR,payload:e}}(e))}))}},W=function(e){var t=e.name,r=(e.urlImageProfile,e.text),n=Object(a.useContext)(h).setView;return Object(p.jsx)("div",{className:" pr-2 pl-1 mb-3 ",onClick:function(){n(j.VIEW_CHAT.value)},children:Object(p.jsxs)("div",{className:"d-flex flex-nowrap border-shadow w-100 my-2 p-2 overflow-hidden",style:{backgroundColor:"#F9F6FA"},children:[Object(p.jsx)("div",{className:"mx-2",children:Object(p.jsx)("img",{src:b,className:"rounded-circle ",width:"50px",alt:"foto del contacto"})}),Object(p.jsxs)("div",{className:"mx-2",children:[Object(p.jsx)("label",{className:"w-100 fw-bold my-0",children:t}),Object(p.jsx)("span",{className:"w-100 fs-12 my-0  t-0",children:r})]})]})})};var L=function(){var e=Object(d.c)((function(e){return e.chats})),t=Object(d.b)(),r=Object(d.c)((function(e){return e.user}));return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("label",{children:"Mis Chats"}),e.result.map((function(e){var a=e.members[1],n=e.messages[e.messages.length-1],c=e,s=c.members[0].username===r.result.username?c.members[1].username:c.members[0].username;return a?Object(p.jsx)("div",{onClick:function(){return r=e._id,t(V(r));var r},children:Object(p.jsx)(W,{name:s,urlImageProfile:a.imageProfile,text:n&&n.text})},e._id):Object(p.jsx)(p.Fragment,{})}))]})};var z=function(){var e=Object(d.c)((function(e){return e.searchUsers})),t=Object(d.b)();return Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{className:"border p-3 pr-5 w-100",style:{backgroundColor:"#3498DB",color:"white",borderRadius:5},children:"Buscando usuarios..."}),null!==e.result.UsersSearchData&&(0!==e.result.UsersSearchData.length?e.result.UsersSearchData.map((function(e,r){return Object(p.jsx)("div",{onClick:function(){return function(e){t(I(e))}(r)},children:Object(p.jsx)(W,{name:e.username,urlImageProfile:e.imageProfile,text:"Estoy disponible en Chat App"})},e._id)})):Object(p.jsx)("div",{className:"mt-3",children:"No se encontro este usuario..."}))]})};var M=function(){var e=Object(d.c)((function(e){return e.searchUsers}));return Object(p.jsxs)("div",{className:"view-lista-chat-container",style:{backgroundColor:"white"},children:[Object(p.jsx)(O,{}),Object(p.jsxs)("div",{className:"mt-1",children:[Object(p.jsx)(N,{}),Object(p.jsx)("div",{className:"border p-3",style:{height:"80vh",overflow:"auto"},children:e.result.usersSearchModeActive?Object(p.jsx)(z,{}):Object(p.jsx)(L,{})})]})]})},G=r(50),Y=r(37),Q=r(159);var Z=function(e){var t=e.setShowModal,r=Object(d.c)((function(e){return e.chat})),n=Object(d.c)((function(e){return e.searchUsers})),c=Object(d.c)((function(e){return e.user})),s=Object(a.useContext)(h).setView;return Object(p.jsxs)("div",{className:"bg-primary d-flex  py-3 border-shadow-title justify-content-between",children:[Object(p.jsxs)("div",{className:" d-flex flex-nowrap",children:[Object(p.jsx)("div",{className:"my-2 mx-3 d-flex hover",onClick:function(){s(j.VIEW_LISTA_CHAT.value)},children:Object(p.jsx)("img",{src:"data:image/png;base64,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",alt:"",width:"35px"})}),Object(p.jsxs)("div",{className:"d-flex flex-nowrap ",children:[Object(p.jsx)("div",{className:"ml-1",children:Object(p.jsx)("img",{src:b,className:"rounded-circle",width:"50px",alt:"foto del contacto"})}),Object(p.jsxs)("div",{className:"mx-2",children:[Object(p.jsx)("label",{className:"w-100 fw-bold my-0 c-white",children:function(){if(n.result.usersSearchModeActive){var e=n.result.UsersSearchData[n.result.indexUserSearchedSelected];return e&&e.username}if(r.result&&""!==r.result.author){var t=r.result;return t.members[0].username===c.result.username?t.members[1].username:t.members[0].username}}()}),Object(p.jsx)("span",{className:"w-100 fs-12 my-0 c-white t-0",children:function(){if(n.result.usersSearchModeActive){var e=n.result.UsersSearchData[n.result.indexUserSearchedSelected];return e&&e.active?"Activo":"Inactivo"}if(r.result&&r.result.members.length>0)return r.result&&r.result.members[1].active?"Activo":"Inactivo"}()})]})]})]}),Object(p.jsx)("div",{className:"m-2",children:Object(p.jsxs)(Q.a,{children:[Object(p.jsx)(Q.a.Toggle,{variant:"secondary"}),Object(p.jsx)(Q.a.Menu,{children:Object(p.jsx)(Q.a.Item,{onClick:function(){return t(!0)},children:"Eliminar Chat"})})]})})]})},J=r(88),X=r.n(J)()("https://brandox-chat-app.herokuapp.com");function q(e){return{type:B,payload:e}}var K,$,ee="INSERT_CHAT";!function(e){e.FIND_CHATS_API_SUCESSS="FIND_CHATS_API_SUCESSS",e.FIND_CHATS_API_STARTED="FIND_CHATS_API_STARTED",e.FIND_CHATS_API_ERROR="FIND_CHATS_API_ERROR"}(K||(K={})),function(e){e.INSERT_CHAT_API_STARTED="INSERT_CHAT_API_STARTED",e.INSERT_CHAT_API_SUCESSS="INSERT_CHAT_API_SUCESSS",e.INSERT_CHAT_API_ERROR="INSERT_CHAT_API_ERROR"}($||($={}));var te="UPDATE_CHATS",re="DELETE_CHAT";function ae(e,t){return{type:te,payload:{chat:t,chatId:e}}}var ne,ce,se,oe=r(27);!function(e){e.FIND_USER_API_SUCCESS="FIND_USER_API_SUCCESS",e.FIND_USER_API_ERROR="FIND_USER_API_ERROR",e.FIND_USER_API_STARTED="FIND_USER_API_STARTED"}(ne||(ne={})),function(e){e.UPDATE_USER_API_SUCCESS="UPDATE_USER_API_SUCCESS",e.UPDATE_USER_API_ERROR="UPDATE_USER_API_ERROR",e.UPDATE_USER_API_STARTED="UPDATE_USER_API_STARTED"}(ce||(ce={})),function(e){e.SET_PASSWORD="SET_PASSWORD",e.SET_ACTIVE="SET_ACTIVE",e.SET_IMAGE_PROFILE="SET_IMAGE_PROFILE",e.ADD_CONTACT="ADD_CONTACT",e.DELETE_CONTACT="DELETE_CONTACT"}(se||(se={}));var ie={error:null,loading:!1,result:{active:!1,contacts:[],imageProfile:"",username:""}};var ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne.FIND_USER_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case ne.FIND_USER_API_SUCCESS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:t.payload});case ne.FIND_USER_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case ce.UPDATE_USER_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case ce.UPDATE_USER_API_SUCCESS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:t.payload});case ce.UPDATE_USER_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});default:return e}},le=r(59),de={error:null,loading:!1,result:[]};var Ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.FIND_CHATS_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case K.FIND_CHATS_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:t.payload});case K.FIND_CHATS_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case $.INSERT_CHAT_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case $.INSERT_CHAT_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:[].concat(Object(le.a)(e.result),[t.payload])});case $.INSERT_CHAT_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case te:return Object(D.a)(Object(D.a)({},e),{},{result:e.result.map((function(e){return e._id==t.payload.chatId?t.payload.chat:e}))});case re:return Object(D.a)(Object(D.a)({},e),{},{result:e.result.filter((function(e){return e._id!==t.payload}))});case ee:return Object(D.a)(Object(D.a)({},e),{},{result:[].concat(Object(le.a)(e.result),[t.payload])});default:return e}},be={error:null,loading:!1,result:null};var je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;if(ve)switch(t.type){case w.FIND_CHAT_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case w.FIND_CHAT_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:t.payload});case w.FIND_CHAT_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case U.UPDATE_CHAT_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case U.UPDATE_CHAT_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:t.payload});case U.UPDATE_CHAT_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case k.DELETE_CHAT_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case k.DELETE_CHAT_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:null});case k.DELETE_CHAT_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload});case F:return Object(D.a)(Object(D.a)({},e),{},{result:null});case B:return Object(D.a)(Object(D.a)({},e),{},{result:t.payload})}return e},Ee={error:null,loading:!1,result:{UsersSearchData:[],usersSearchModeActive:!1,indexUserSearchedSelected:-1}};var fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S.SEARCH_USER_API_STARTED:return Object(D.a)(Object(D.a)({},e),{},{loading:!0});case S.SEARCH_USER_API_SUCESSS:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,result:Object(D.a)(Object(D.a)({},e.result),{},{UsersSearchData:t.payload.usersSearchData})});case S.SEARCH_USER_API_ERROR:return Object(D.a)(Object(D.a)({},e),{},{loading:!1,error:t.payload.error});case v.SET_USERS_SEARCH_MODE_ACTIVE_SYNC:return Object(D.a)(Object(D.a)({},e),{},{result:Object(D.a)(Object(D.a)({},e.result),{},{usersSearchModeActive:t.payload.active})});case v.SET_INDEX_USER_SEARCHED_SELECTED:return Object(D.a)(Object(D.a)({},e),{},{result:Object(D.a)(Object(D.a)({},e.result),{},{indexUserSearchedSelected:t.payload.indexUserSearchedSelected})});default:return e}},he=r(89),pe=r(90),Se=Object(oe.combineReducers)({user:ue,chats:Ae,chat:je,searchUsers:fe}),ve=Object(oe.createStore)(Se,Object(he.composeWithDevTools)(Object(oe.applyMiddleware)(pe.a)));var Oe=function(e){var t=e.userId,r=e.chat;if(console.log("NEW MESSAGE: AHORA TO EL MUNDO QUIERE HACER TRAP COMO DOWBA"),t!==ve.getState().user.result._id){var a=ve.dispatch,n=r._id;a(q(r)),a(ae(n,r))}};function me(e){return{type:re,payload:e}}var Ie=function(e){};var _e=function(e){var t=e.userId,r=e.chat;console.log("Se ha recibido delete chat");var a=ve.getState().user.result._id,n=ve.getState().chat.result;if(t!==a){var c=ve.dispatch;n._id==r._id&&c({type:F}),c(me(r._id)),Ie(j.VIEW_LISTA_CHAT.value)}};var ge=function(e){var t,r=e.chat,a=e.userId;if(ve.getState().user.result._id!==a&&(t=r._id,!ve.getState().chats.result.some((function(e){return e._id==t})))){var n=ve.dispatch;console.log("se recibio el crear un nuevo chat: "+r),n(function(e){return{type:ee,payload:e}}(r))}};var Te=function(e){var t=e.chat,r=e.userId;console.log("se ha recibido evento de delete message");var a=ve.getState().user.result._id,n=ve.getState().chat.result;if(r!==a){var c=ve.dispatch;n._id==t._id&&c(q(t)),c(ae(t._id,t))}},Ce="";function xe(e){console.log("se ha emitido borrar chat");var t={chat:e,socketId:Ce};X.emit("DELETE_CHAT",t)}X.on("connect",(function(){Ce=X.id,console.log("my socketId is "+Ce)})),X.on("NEW_MESSAGE",Oe),X.on("DELETE_CHAT",_e),X.on("CREATE_CHAT",ge),X.on("DELETE_MESSAGE",Te);var Re=function(e){return{type:U.UPDATE_CHAT_API_SUCESSS,payload:e}},ye=function(e){return{type:U.UPDATE_CHAT_API_ERROR,payload:e}},Ne=function(e,t){return function(r,a){switch(r({type:U.UPDATE_CHAT_API_STARTED}),t.type){case y.NEW_MESSAGE:var n=t.value;!function(e,t,r,a){var n={field:"messages",value:{type:"PUSH",value:t}};g.put("/chat/"+e,n).then((function(e){return r&&r(e.data)})).catch((function(e){var t;console.log("Inserting new message. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data)),a&&a(e)}))}(e,n,(function(t){!function(e){var t={chatId:e,socketId:Ce};X.emit("NEW_MESSAGE",t)}(e),r(Re(t)),r(ae(e,t))}),(function(e){return r(ye(e))}));break;case y.DELETE_MESSAGE:var c=t.value;!function(e,t,r,a){var n={field:"messages",value:{type:"DELETE",value:t}};g.put("/chat/"+e,n).then((function(e){return r&&r(e.data)})).catch((function(e){var t;console.log("delete message. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data)),a&&a(e)}))}(e,c,(function(t){r(Re(t)),r(ae(e,t)),function(e){console.log("Se ha emitido borrar mensaje");var t={chat:e,socketId:Ce};X.emit("DELETE_MESSAGE",t)}(t)}),(function(e){return r(ye(e))}))}}};var De=function(e){var t=e.children,r=e.date,a=e.username,n=e.iAm,c=e.messageId,s=Object(d.b)(),o=Object(d.c)((function(e){return e.chat.result})),i=n?["right","#F5EEF8"]:["left","#EBDEF0"],u=Object(l.a)(i,2),A=u[0],b=u[1];return Object(p.jsxs)("div",{className:" mx-3 my-2 rounded text-break p-2 float-".concat(A," border-shadow"),style:{width:"70%",backgroundColor:b,boxSizing:"content-box",position:"relative"},children:[n&&Object(p.jsxs)(Q.a,{style:{position:"absolute",bottom:0,right:0,transform:"scale(0.8)",zIndex:1},children:[Object(p.jsx)(Q.a.Toggle,{variant:"secondary"}),Object(p.jsx)(Q.a.Menu,{children:Object(p.jsx)(Q.a.Item,{onClick:function(){var e=o._id;s(Ne(e,{type:y.DELETE_MESSAGE,value:c}))},children:"Borrar Mensaje"})})]}),Object(p.jsxs)("div",{className:"d-flex justify-content-between ",children:[Object(p.jsx)("label",{className:"text-nowrap  ",children:a}),Object(p.jsx)("span",{className:"text-nowrap ",children:r})]}),Object(p.jsx)("div",{children:t})]})},He=function(e,t,r){return function(a,n){a({type:$.INSERT_CHAT_API_STARTED}),function(e,t,r,a){var n=Object(D.a)(Object(D.a)({},H),{},{author:e,members:[e,t]});g.post("/chat",n).then((function(e){return r&&r(e.data)})).catch((function(e){var t;a&&a(e),console.log("Creating new chat. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data))}))}(e,t,(function(e){a(function(e){return{type:$.INSERT_CHAT_API_SUCESSS,payload:e}}(e)),a(q(e)),r&&r(e),function(e){console.log("Se ha emitido create chat");var t={chat:e,socketId:Ce};X.emit("CREATE_CHAT",t)}(e)}),(function(e){a(function(e){return{type:$.INSERT_CHAT_API_ERROR,payload:e}}(e))}))}};var Pe=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),r=t[0],n=t[1],c=Object(a.useState)(!1),s=Object(l.a)(c,2),o=s[0],i=s[1],u=Object(d.b)(),A=Object(d.c)((function(e){return e.user})),b=Object(d.c)((function(e){return e.chat})),j=b.result,E=Object(d.c)((function(e){return e.searchUsers})),f=Object(d.c)((function(e){return e.chats}));Object(a.useEffect)((function(){S()}),[j&&j.messages]),Object(a.useEffect)((function(){var e=!1,t="",r=E.result.UsersSearchData[E.result.indexUserSearchedSelected];f.result.forEach((function(a){if(r&&a.members[1].username===r.username)return e=!0,void(t=a._id)})),e?(u(V(t)),i(!0)):i(!1)}),[E.result.indexUserSearchedSelected]);var h=Object(a.useRef)(null),S=function(){var e=h.current;e&&(e.scrollTop=e.scrollHeight)},v=function(){if(E.result.usersSearchModeActive&&!o){var e=A.result._id,t=E.result.UsersSearchData[E.result.indexUserSearchedSelected];if(t){var a=e,c=t._id;u(He(a,c,(function(e){var t=e._id,a={author:A.result,date:new Date,text:r};u(Ne(t,{type:y.NEW_MESSAGE,value:a})),i(!0),n("")})))}else console.log("can't send mensaje")}else{var s={author:A.result,date:new Date,text:r},l=j._id;u(Ne(l,{type:y.NEW_MESSAGE,value:s})),n("")}};return Object(p.jsxs)("div",{className:"vh-100",children:[Object(p.jsx)("div",{ref:h,className:"border my-2",style:{overflow:"auto",height:"calc(100% - 145px)",transition:"all 0.5s"},children:function(){if(E.result.usersSearchModeActive&&!o){var e=E.result.UsersSearchData[E.result.indexUserSearchedSelected];return Object(p.jsxs)("div",{className:"text-center pt-2",children:["Escribele a ",e&&e.username]})}return b.result&&b.result.messages.map((function(e){var t=function(e){var t=e.getHours(),r=e.getMinutes(),a=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+(r=r<10?"0"+r:r)+" "+a}(new Date(e.date)),r=e.author._id===A.result._id;return Object(p.jsx)("div",{children:Object(p.jsx)(De,{iAm:r,username:e.author.username,date:t,messageId:e._id,children:e.text})},e._id)}))}()}),Object(p.jsx)("div",{className:" ",children:Object(p.jsxs)("div",{className:"d-flex flex-nowrap pb-2",children:[Object(p.jsx)("input",{onChange:function(e){n(e.currentTarget.value)},placeholder:"Escribe algo...",value:r,className:"form-control ",style:{backgroundColor:"#F8F9F9"},onKeyPress:function(e){return"Enter"===e.key&&v()}}),Object(p.jsx)("img",{src:"data:image/png;base64,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",alt:"boton enviar",width:"35px",className:"ml-2",onClick:v})]})})]})},Ue=function(e){return{type:k.DELETE_CHAT_API_SUCESSS,payload:e}},we=function(e){return{type:k.DELETE_CHAT_API_ERROR,payload:e}},ke=function(e){};var Be=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.chat})).result,r=Object(d.c)((function(e){return e.searchUsers})),n=Object(a.useState)(!1),c=Object(l.a)(n,2),s=c[0],o=c[1],A=!(-1===r.result.indexUserSearchedSelected&&!t),b=function(){e(function(){var e=Object(u.a)(i.a.mark((function e(t,r){var a,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null===(a=r().chat.result)||void 0===a?void 0:a._id,c=r().chat.result,t({type:k.DELETE_CHAT_API_ERROR}),P(n,(function(e){ke(j.VIEW_LISTA_CHAT.value),t(Ue(e)),t(me(n)),xe(c)}),(function(e){t(we(e))}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())};return Object(p.jsx)("div",{className:"vh-100 view-chat-container",style:{backgroundColor:"white",position:"relative"},children:A?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(G.a,{show:s,centered:!0,children:[Object(p.jsxs)(G.a.Header,{className:"",children:[Object(p.jsx)("strong",{className:"fw-bold",children:"Enserio quieres eliminar este chat?"}),Object(p.jsx)("img",{src:"data:image/png;base64,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",alt:"image of delete chat"})]}),Object(p.jsxs)(G.a.Footer,{children:[Object(p.jsx)(Y.a,{variant:"danger",onClick:function(){return o(!1)},children:"Cancelar"}),Object(p.jsx)(Y.a,{variant:"info",onClick:function(){o(!1),b()},children:"Confirmar"})]})]}),Object(p.jsx)(Z,{setShowModal:o}),Object(p.jsx)(Pe,{})]}):Object(p.jsxs)("div",{className:"border h-100 d-flex justify-content-center align-items-center ",children:[" ",Object(p.jsx)("span",{children:"Escribele a alguien \ud83d\ude01\ud83d\udc4c"})]})})},Fe=function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}localStorage.setItem("token",t),e.next=6;break;case 4:return r=localStorage.getItem("token"),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(u.a)(i.a.mark((function e(t,r,a){var n,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={username:t,password:r,userLogImage:a},e.prev=1,console.log(n),e.next=5,g.post("/sign",n);case 5:return c=e.sent,e.abrupt("return",c.data);case 9:return e.prev=9,e.t0=e.catch(1),console.log("Registering new user. Error ".concat(null===(s=e.t0.response)||void 0===s?void 0:s.data)),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,r,a){return e.apply(this,arguments)}}(),We=function(){var e=Object(u.a)(i.a.mark((function e(t,r){var a,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={user:{username:t,password:r}},e.prev=1,e.next=4,g.post("/log",a);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:return e.prev=8,e.t0=e.catch(1),console.log("Verifing user correct. Error ".concat(null===(c=e.t0.response)||void 0===c?void 0:c.data)),e.abrupt("return",{token:null});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}(),Le=function(){var e=Object(u.a)(i.a.mark((function e(t){var r,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={token:t},e.prev=1,e.next=4,g.post("log",r);case 4:return a=e.sent,e.abrupt("return",a.data.tokenValid);case 8:return e.prev=8,e.t0=e.catch(1),console.log("Verifing valid token. Error ".concat(null===(n=e.t0.response)||void 0===n?void 0:n.data)),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),ze=r(160),Me=function(){return function(e,t){e({type:K.FIND_CHATS_API_STARTED}),function(e,t,r){var a={params:{member1:e}};g.get("/chat",a).then((function(e){return t&&t(e.data)})).catch((function(e){var t;r&&r(e),console.log("delete message. Error ".concat(null===(t=e.response)||void 0===t?void 0:t.data))}))}(t().user.result._id,(function(t){return e((r=t,{type:K.FIND_CHATS_API_SUCESSS,payload:r}));var r}),(function(t){return e(function(e){return{type:K.FIND_CHATS_API_ERROR,payload:e}}(t))}))}},Ge=function(e){return function(t,r){t({type:ne.FIND_USER_API_STARTED}),function(e,t,r){g.get("user/".concat(e)).then((function(e){return t&&t(e.data)})).catch((function(e){var t;r&&r(e),console.log(null===(t=e.response)||void 0===t?void 0:t.data)}))}(e,(function(e){return t((r=e,{type:ne.FIND_USER_API_SUCCESS,payload:r}));var r}),(function(e){return t(function(e){return{type:ne.FIND_USER_API_ERROR,payload:e}}(e))}))}},Ye=r(46),Qe=r.n(Ye);var Ze=function(e){var t=e.switchFacialReconitionAndLoginWithCredentialsViews,r=e.runLoadApp,c=n.a.useRef(null),s=Object(a.useState)(!1),o=Object(l.a)(s,2),d=o[0],A=o[1];function b(){return(b=Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.current.getScreenshot(),a={resource:{userId:"604ee937a0b0111d94cb4ece",base64image:t}},A(!0),g.post("/log",a).then((function(e){A(!1);var t=e.data,a=t.username,n=t.token;n?(console.log(e.data),r(n),alert("Has sido indentificado como "+a)):alert("Tu cara no coincide")})).catch((function(e){return console.log(e)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(p.jsxs)("div",{className:"d-flex justify-content-center align-items-center w-100 vh-100",style:{backgroundColor:"#F6F6F6",position:"relative"},children:[d&&Object(p.jsxs)("div",{className:"d-flex justify-content-center align-items-center  text-success ",style:{transform:"scale(2)",margin:"auto",position:"absolute",left:"calc(50% - 30px)",zIndex:1},children:[Object(p.jsx)("div",{className:"spinner-border ms-auto ",role:"status","aria-hidden":"true"}),Object(p.jsx)("strong",{className:"ml-3",style:{},children:"Loading..."})]}),Object(p.jsxs)("div",{className:"card border p-4",style:{width:600,filter:d?"blur(5px)":""},children:[Object(p.jsx)("img",{style:{position:"absolute",left:0},className:"ml-4 hover",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAdCAYAAADGgB7AAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAPLSURBVFhHjZbbVRxBDEQ3GrNPnATfBpIEUiIBAiCBta56bk/teDnHH2WppZJUo55ZvNsfj1dwPJ+HPZ0apzof6rzF/nCYvlz9zhGr2vPlMvOAfljjnsHl8bHPWPL4OxoBRLWt5sBihmKNZf4uintamm9FcHbwTc0mh53C3FhuAtw7P+z3U7BD5Nkv88ljqDnP+jcbe2ADRfQ6KXIIm8kmmUsO+blR+NWcAfLwBTFADUJSjNwW1mKKiMDe3AK3ko04Y3MAMR+gY5UHOcw6kT3hAd8zz32VPCXCuulSZKF2Do6z9uadI7ZwGJA8LBzi5oVn+7cwRfV10rygEGzCQsUYAzSmBz0dIh/I2cYzrz+F0XArTPhECWPk/zw/Xz8/P69PT0/jdQiOw+xlfYqAx1WSf/z9u89TGBa4iWwmiOe1EXt+ebl+fX1d397fB4/4Ug8caE/PDMfKy4doYV6hDR0OwYZp9eEo6r1EzXxZvkrO9MAK8goxho9YfARxnhv7VV+g4iTbxCcBxBCEfXl9naIcRK5fhzoTM27PHGzsJ/TvmNtSjEWc8RWkzzuFqI+PjxkH7VMfPbApKPtPnM79bskB8yr7y1yaKwjo25A8L/r39/d/w9rso8gWcx6+4rja9atcgBCS+vlDK8drfHt765zoGgQsA60TnskpYPglrLaGr+CdRCyNbWLsHuD98zUKOEut12Jf8vTFmhtzSlQBDmKJ7/gnB0IUOVAOMHfvq2SIG7Mn9lbI7YMfjpWvrTUWXm9sJdwKoCkkBZPHchZ5rWPYEGYP6/AVBtZrxK8f1RAGd+cwbf6XBmtTgBB9OSkOe77UD2jlyYHk4mMdrlBqFMaVEp/CbIC1AfaeGH3zWcfGuBp8BaQYfLFyKr8Iu5RIci0MsCmI+IpxIER9cpkH5scwsT6gfK4vew7+eJjeVAk7Lu/b3BjFXmMOUwg+T2dMHo31x3lsbB1668PxTD96Yb3GG2FJXgfcDjQGaKafuWHpMx4qa4APixD8cY0jznvm1loYCQZthQFixs3ZCLv98R01450h5penEOGV5oyO8+Ec6r8+9ZX2xhzqJiBZZC55xhGmjx3guleedeb1FZv9EMXWsL2xbZO0P/k2N85D+WD5jsnBJ5ZzthvF8o6BHc22Lz1FNsrhNgXk0zc36t3eKkI+/cTKH/nug0VYH5akRKzvjOCcg5KDzfzDfmzO4fjWuKX0BTHssez8k9SBaGDM3zfzmcMiCJs5fTnZWxCTk+hc4ce/lUkkDtyQMfJbYcbZFtaYHPsCa8xRM2LH618i/rSj5Ifp+AAAAABJRU5ErkJggg==",alt:"back-image",onClick:t}),Object(p.jsx)("h2",{className:"mb-4 text-center",children:"Inicio de Sesion"}),Object(p.jsx)(Qe.a,{audio:!1,ref:c,screenshotFormat:"image/jpeg",className:"w-100 mb-3"}),Object(p.jsx)("p",{children:"Debe mirar a la camara y no hacer expresiones extranas, porfavor tener los menos elementos posibles y tambien que solo se vea su cara de preferencia"}),Object(p.jsx)("button",{onClick:function(){return b.apply(this,arguments)},className:"btn btn-primary",children:"Iniciar Sesion"})]})]})},Je=(r(84),{messageError:"",bootstrapStyleInput:""}),Xe=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.user})),r=Object(d.c)((function(e){return e.chats})),n=Object(a.useState)(!1),c=Object(l.a)(n,2),s=c[0],o=c[1],A=Object(a.useState)(Je),b=Object(l.a)(A,2),E=b[0],f=b[1],S=Object(a.useState)(""),v=Object(l.a)(S,2),O=v[0],m=v[1],I=Object(a.useState)(""),_=Object(l.a)(I,2),g=_[0],x=_[1],R=Object(ze.a)(g,700),y=Object(l.a)(R,1)[0],N=Object(a.useContext)(h).setView;Object(a.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===g){e.next=5;break}return e.next=3,T(g);case 3:t=e.sent,f(t?{bootstrapStyleInput:"",messageError:""}:{bootstrapStyleInput:"is-invalid",messageError:"Este usuario no existe"});case 5:case"end":return e.stop()}}),e)})))()}),[y]),Object(a.useEffect)((function(){t.loading||""===O||e(Me())}),[t.loading]),Object(a.useEffect)((function(){r.loading||""===O||(m(""),x(""),N(j.VIEW_LISTA_CHAT.value))}),[r.loading]);var D=function(){var t=Object(u.a)(i.a.mark((function t(){var r,a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==E.messageError||""===g||""===O){t.next=14;break}return t.next=3,We(g,O);case 3:if(r=t.sent,!(a=r.token)){t.next=13;break}return Fe(a),t.next=9,C(a);case 9:(n=t.sent)&&e(Ge(n._id)),t.next=14;break;case 13:alert("Contrasena incorrecta");case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();function H(){return(H=Object(u.a)(i.a.mark((function t(r){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe(r),t.next=3,C(r);case 3:(a=t.sent)&&e(Ge(a._id));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var P=function(){return o(!s)};return Object(p.jsx)(p.Fragment,{children:s?Object(p.jsx)(Ze,{switchFacialReconitionAndLoginWithCredentialsViews:P,runLoadApp:function(e){return H.apply(this,arguments)}}):Object(p.jsx)("div",{className:"d-flex justify-content-center align-items-center w-100 vh-100",style:{backgroundColor:"#F6F6F6"},children:Object(p.jsxs)("div",{className:"card border p-5",style:{width:500},children:[Object(p.jsx)("h2",{className:"mb-4",children:"Inicio de Sesion"}),Object(p.jsxs)("div",{className:"p-1",children:[Object(p.jsx)("label",{className:"mr-3",children:"Usuario"}),Object(p.jsx)("input",{className:"form-control ".concat(E.bootstrapStyleInput," ").concat(E.bootstrapStyleInput),type:"text",value:g,onChange:function(e){return x(e.currentTarget.value)}}),Object(p.jsxs)("span",{style:{color:"#F94D4D"},children:[E.messageError,E.messageError]})]}),Object(p.jsxs)("div",{className:"p-1",children:[Object(p.jsx)("label",{className:"mr-3",children:"Contrasena"}),Object(p.jsx)("input",{className:"form-control",type:"password",value:O,onChange:function(e){return m(e.currentTarget.value)}})]}),Object(p.jsxs)("div",{className:"mt-5 d-flex justify-content-between mt-2",children:[Object(p.jsx)("a",{className:"link-info hover",onClick:P,children:"Reconocimiento Facial"}),Object(p.jsx)("button",{onClick:D,className:"btn btn-primary",children:"Iniciar Sesion"})]}),Object(p.jsx)("div",{className:"d-flex justify-content-center",children:Object(p.jsx)("span",{className:"link-info hover",onClick:function(){N(j.VIEW_SIGNIN.value)},style:{position:"absolute",bottom:10},children:"Crear Cuenta"})})]})})})},qe=r(58),Ke=function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={messageError:"",bootstrapStyleInput:"is-valid"},et(t)?t.trim().length<=5?(r.messageError="La usuario debe tener mas de 5 caracteres",r.bootstrapStyleInput="is-invalid"):$e(t.trim())||(r.messageError="La usuario debe tener por lo menos 2 numeros",r.bootstrapStyleInput="is-invalid"):(r.messageError="El usuario no puede tener espacios en blanco",r.bootstrapStyleInput="is-invalid"),e.next=4,T(t);case 4:return e.sent&&(r.bootstrapStyleInput="is-invalid",r.messageError="Este nombre de  usuario ya existe"),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=function(e){var t,r,a=0,n=Object(qe.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;r=Number(c),Number(r)===r&&a++}}catch(s){n.e(s)}finally{n.f()}return a>=2},et=function(e){var t,r=Object(qe.a)(e);try{for(r.s();!(t=r.n()).done;){if(" "===t.value)return!1}}catch(a){r.e(a)}finally{r.f()}return!0};var tt={messageError:"",bootstrapStyleInput:""},rt=function(){var e=Object(d.b)(),t=Object(a.useRef)(null),r=Object(a.useContext)(h).setView,n=Object(a.useState)(""),c=Object(l.a)(n,2),s=c[0],o=c[1],A=Object(a.useState)(""),b=Object(l.a)(A,2),E=b[0],f=b[1],S=Object(m.useDebounce)(E,700),v=Object(l.a)(S,1)[0],O=Object(a.useState)(tt),I=Object(l.a)(O,2),_=I[0],g=I[1],T=Object(a.useState)(tt),x=Object(l.a)(T,2),R=x[0],y=x[1];Object(a.useEffect)((function(){Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===E){e.next=5;break}return e.next=3,Ke(E);case 3:t=e.sent,g(t);case 5:case"end":return e.stop()}}),e)})))()}),[v]),Object(a.useEffect)((function(){var e=function(e){var t={messageError:"",bootstrapStyleInput:"is-valid"};return et(e)?e.length<=5?(t.messageError="La contrasena debe tener mas de 5 caracteres",t.bootstrapStyleInput="is-invalid"):$e(e)||(t.messageError="La contrasena debe tener por lo menos 2 numeros",t.bootstrapStyleInput="is-invalid"):(t.messageError="La contrasena no puede tener espacios en blanco",t.bootstrapStyleInput="is-invalid"),t}(s);y(e)}),[s]);var N=function(){var a=Object(u.a)(i.a.mark((function a(){var n,c,o;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(""!==_.messageError||""!==_.messageError||""===E||""===s){a.next=14;break}if(t.current){a.next=3;break}throw new Error;case 3:return n=t.current.getScreenshot(),a.next=6,Ve(E,s,n);case 6:return c=a.sent,Fe(c),a.next=10,C(c);case 10:o=a.sent,e(Ge(o._id)),e(Me()),r(j.VIEW_LISTA_CHAT.value);case 14:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return Object(p.jsx)("div",{className:"d-flex justify-content-center align-items-center w-100 vh-100",style:{backgroundColor:"#F6F6F6"},children:Object(p.jsxs)("div",{className:"card p-4",style:{width:420},children:[Object(p.jsx)("h2",{className:"mb-4",children:"Crear Cuenta"}),Object(p.jsx)(Qe.a,{ref:t,audio:!1,screenshotFormat:"image/jpeg",className:"w-100"}),Object(p.jsx)("span",{className:"text-center",children:"Mira a la camara, trata de que solo se vea tu cara y de que halla luz cuando des a iniciar sesion"}),Object(p.jsxs)("div",{className:"p-1",children:[Object(p.jsx)("label",{className:"mr-3",children:"Usuario"}),Object(p.jsx)("input",{className:"form-control ".concat(_.bootstrapStyleInput," ").concat(_.bootstrapStyleInput),type:"text",value:E,onChange:function(e){return t=e.currentTarget.value,f(t);var t}}),Object(p.jsx)("span",{style:{color:"#F94D4D"},children:_.messageError})]}),Object(p.jsxs)("div",{className:"p-1",children:[Object(p.jsx)("label",{className:"mr-3",children:"Contrasena"}),Object(p.jsx)("input",{className:"form-control ".concat(R.bootstrapStyleInput),type:"password",value:s,onChange:function(e){return o(e.currentTarget.value)}}),Object(p.jsx)("span",{style:{color:"#F94D4D"},children:R.messageError})]}),Object(p.jsx)("div",{className:"mt-3 d-flex justify-content-center",children:Object(p.jsx)("button",{onClick:N,className:"btn btn-primary",children:"Crear la cuenta"})}),Object(p.jsx)("div",{className:"mb-3 d-flex justify-content-center",children:Object(p.jsx)("span",{className:"nav-link active hover",onClick:function(){return r(j.VIEW_LOGIN.value)},style:{position:"absolute",bottom:0},children:"Iniciar Sesion"})})]})})},at=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return e.chats})),r=(Object(d.c)((function(e){return e.chat})),Object(d.c)((function(e){return e.user}))),n=Object(a.useReducer)(E,j),c=Object(l.a)(n,2),s=c[0],o=c[1],A=Object(a.useReducer)((function(e){return e+1}),0),b=Object(l.a)(A,2),f=(b[0],b[1]),S=Object(a.useState)(""),v=Object(l.a)(S,2),O=v[0],m=v[1],I=Object(a.useState)(!0),_=Object(l.a)(I,2),g=_[0],T=_[1];function x(e){o(e),f()}return Object(a.useEffect)((function(){Object(u.a)(i.a.mark((function t(){var r,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fe();case 2:if(!(r=t.sent)){t.next=13;break}return t.next=6,Le(r);case 6:if(!t.sent){t.next=13;break}return x(j.VIEW_LISTA_CHAT.value),t.next=11,C(r);case 11:(a=t.sent)&&e(Ge(a._id));case 13:case"end":return t.stop()}}),t)})))()}),[]),Object(a.useEffect)((function(){r.loading||""===r.result.username||(!function(e){var t={userId:e,socketId:Ce};X.emit("NEW_CONNECTION",t)}(r.result._id),e(Me()))}),[r.loading]),Object(a.useEffect)((function(){if(!t.loading&&t.result.length>0&&g){T(!1);var r=t.result[0]._id;e(V(r))}}),[t.loading]),Object(p.jsx)(h.Provider,{value:{setView:x,activeChatId:O,setActiveChatId:m},children:Object(p.jsx)("div",{className:"container-fluid",style:{backgroundColor:" #FCFCFC"},children:Object(p.jsxs)("div",{className:"row vh-100",children:[""!==s.VIEW_LOGIN.display&&""!==s.VIEW_SIGNIN.display&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"col-12 col-md-5 ".concat(s.VIEW_LISTA_CHAT.display),children:Object(p.jsx)(M,{})}),Object(p.jsx)("div",{className:"col-12 col-md-7 ".concat(s.VIEW_CHAT.display),children:Object(p.jsx)(Be,{})})]}),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"col-12 ".concat(s.VIEW_LOGIN.display," "),children:Object(p.jsx)(Xe,{})}),Object(p.jsx)("div",{className:"col-12 ".concat(s.VIEW_SIGNIN.display),children:Object(p.jsx)(rt,{})})]})]})})})};window.addEventListener("beforeunload",(function(e){setTimeout((function(){console.log("Se ha emitido cerrar conexion"),X.emit("CLOSE_CONNECTION",Ce),e.preventDefault(),e.returnValue="Enserio?"}),2e3)}));var nt=function(){return Object(p.jsx)(d.a,{store:ve,children:Object(p.jsx)(at,{})})};s.a.render(Object(p.jsx)(nt,{}),document.getElementById("root"))},84:function(e,t,r){}},[[153,1,2]]]);
//# sourceMappingURL=main.dc2e1129.chunk.js.map